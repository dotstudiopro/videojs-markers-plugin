/*! videojs-markers-plugin - v1.0.2 - 2020-10-20
* Copyright (c) 2020 ; Licensed  */

!function(e,t){"function"==typeof define&&define.amd?define(["video.js"],t):"undefined"!=typeof exports?t(require("video.js")):(t(e.videojs),e.videojsMarkersPlugin={})}(this,function(e){"use strict";var t,p=(t=e)&&t.__esModule?t:{default:t};var x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h={markerStyle:{width:"7px","border-radius":"30%","background-color":"red"},markerTip:{display:!0,text:function(e){return"Break: "+e.text},time:function(e){return e.time}},breakOverlay:{display:!1,displayTime:3,text:function(e){return"Break overlay: "+e.overlayText},style:{width:"100%",height:"20%","background-color":"rgba(0,0,0,0.7)",color:"white","font-size":"17px"}},onMarkerClick:function(){},onMarkerReached:function(){},markers:[]};function b(e){var t;try{t=e.getBoundingClientRect()}catch(e){t={top:0,bottom:0,left:0,width:0,height:0,right:0}}return t}var g=-1;p.default.registerPlugin("markers",function(e){var a,t;p.default.mergeOptions||(a=function(e){return!!e&&"object"===(void 0===e?"undefined":x(e))&&"[object Object]"===toString.call(e)&&e.constructor===Object},t=function i(e,t){var n={};return[e,t].forEach(function(r){r&&Object.keys(r).forEach(function(e){var t=r[e];a(t)?(a(n[e])||(n[e]={}),n[e]=i(n[e],t)):n[e]=t})}),n},p.default.mergeOptions=t),p.default.dom.createEl||(p.default.dom.createEl=function(e,t,r){var i=p.default.Player.prototype.dom.createEl(e,t);return r&&Object.keys(r).forEach(function(e){i.setAttribute(e,r[e])}),i});var n=p.default.mergeOptions(h,e),i={},o=[],u=g,l=this,c=null,f=null,m=g;function s(){o.sort(function(e,t){return n.markerTip.time(e)-n.markerTip.time(t)})}function r(e){e.forEach(function(e){var r;e.key=(r=(new Date).getTime(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"==e?t:3&t|8).toString(16)})),l.el().querySelector(".vjs-progress-holder").appendChild(function(r){var e=p.default.dom.createEl("div",{},{"data-marker-key":r.key,"data-marker-time":n.markerTip.time(r)});y(r,e),e.addEventListener("click",function(e){var t=!1;"function"==typeof n.onMarkerClick&&(t=!1===n.onMarkerClick(r)),t||(t=this.getAttribute("data-marker-key"),l.currentTime(n.markerTip.time(i[t])))}),n.markerTip.display&&function(r){r.addEventListener("mouseover",function(){var e,t=i[r.getAttribute("data-marker-key")];c&&(n.markerTip.html?c.querySelector(".vjs-tip-inner").innerHTML=n.markerTip.html(t):c.querySelector(".vjs-tip-inner").innerText=n.markerTip.text(t),c.style.left=d(t)+"%",e=b(c),t=b(r),c.style.marginLeft=-parseFloat(e.width/2)+parseFloat(t.width/4)+"px",c.style.visibility="visible")}),r.addEventListener("mouseout",function(){c&&(c.style.visibility="hidden")})}(e);return e}(e)),i[e.key]=e,o.push(e)}),s()}function d(e){return n.markerTip.time(e)/l.duration()*100}function y(e,t){t.className="vjs-marker "+(e.class||""),Object.keys(n.markerStyle).forEach(function(e){t.style[e]=n.markerStyle[e]});var r=e.time/l.duration();(r<0||1<r)&&(t.style.display="none"),t.style.left=d(e)+"%",e.duration?(t.style.width=e.duration/l.duration()*100+"%",t.style.marginLeft="0px"):(e=b(t),t.style.marginLeft=e.width/2+"px")}function k(e){f&&(m=g,f.style.visibility="hidden"),u=g;var r=[];e.forEach(function(e){var t=o[e];t&&(delete i[t.key],r.push(e),(t=l.el().querySelector(".vjs-marker[data-marker-key='"+t.key+"']"))&&t.parentNode.removeChild(t))}),r.reverse(),r.forEach(function(e){o.splice(e,1)}),s()}function v(){var e,t,r;!n.breakOverlay.display||u<0||(e=l.currentTime(),t=o[u],(r=n.markerTip.time(t))<=e&&e<=r+n.breakOverlay.displayTime?(m!==u&&(m=u,f&&(f.querySelector(".vjs-break-overlay-text").innerHTML=n.breakOverlay.text(t))),f&&(f.style.visibility="visible")):(m=g,f&&(f.style.visibility="hidden")))}l.markers={getMarkers:function(){return o},next:function(){for(var e=l.currentTime(),t=0;t<o.length;t++){var r=n.markerTip.time(o[t]);if(e<r){l.currentTime(r);break}}},prev:function(){for(var e=l.currentTime(),t=o.length-1;0<=t;t--){var r=n.markerTip.time(o[t]);if(r+.5<e)return void l.currentTime(r)}},add:function(e){r(e)},remove:function(e){k(e)},removeAll:function(){for(var e=[],t=0;t<o.length;t++)e.push(t);k(e)},updateTime:function(e){var i;i=e,o.forEach(function(e){var t=l.el().querySelector(".vjs-marker[data-marker-key='"+e.key+"']"),r=n.markerTip.time(e);!i&&t.getAttribute("data-marker-time")===r||(y(e,t),t.setAttribute("data-marker-time",r))}),s()},reset:function(e){l.markers.removeAll(),r(e)},destroy:function(){l.markers.removeAll(),f&&f.remove(),c&&c.remove(),l.off("timeupdate",v),delete l.markers}}})});